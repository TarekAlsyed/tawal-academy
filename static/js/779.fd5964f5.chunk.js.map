{"version":3,"file":"static/js/779.fd5964f5.chunk.js","mappings":"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","sources":["pages/student/Exam.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { toast } from 'react-toastify';\nimport { useAuth } from '../../context/AuthContext';\nimport api from '../../services/api';\nimport { API_ENDPOINTS } from '../../config/api';\nimport '../../styles/Exam.css';\n\nconst Exam = () => {\n  const { id } = useParams();\n  const navigate = useNavigate();\n  const { user } = useAuth();\n  const [exam, setExam] = useState(null);\n  const [answers, setAnswers] = useState({});\n  const [loading, setLoading] = useState(true);\n  const [submitting, setSubmitting] = useState(false);\n\n  useEffect(() => {\n    fetchExam();\n    loadProgress();\n    // منع النسخ واللصق\n    document.addEventListener('copy', preventCopy);\n    document.addEventListener('cut', preventCopy);\n    document.addEventListener('contextmenu', preventContextMenu);\n\n    return () => {\n      document.removeEventListener('copy', preventCopy);\n      document.removeEventListener('cut', preventCopy);\n      document.removeEventListener('contextmenu', preventContextMenu);\n    };\n  }, [id]);\n\n  const preventCopy = (e) => {\n    e.preventDefault();\n    toast.error('النسخ غير مسموح في الامتحان');\n  };\n\n  const preventContextMenu = (e) => {\n    e.preventDefault();\n  };\n\n  const fetchExam = async () => {\n    try {\n      setLoading(true);\n      const response = await api.get(API_ENDPOINTS.EXAM_BY_ID(id));\n      if (response.data.success) {\n        setExam(response.data.data.exam);\n      }\n    } catch (error) {\n      toast.error('فشل تحميل الامتحان');\n      navigate('/');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const loadProgress = async () => {\n    try {\n      const response = await api.get(API_ENDPOINTS.EXAM_PROGRESS(id));\n      if (response.data.success && response.data.data.answers) {\n        setAnswers(response.data.data.answers);\n      }\n    } catch (error) {\n      console.error('فشل تحميل التقدم المحفوظ');\n    }\n  };\n\n  const handleAnswerChange = async (questionId, answer) => {\n    const newAnswers = {\n      ...answers,\n      [questionId]: answer\n    };\n    setAnswers(newAnswers);\n\n    // حفظ التقدم تلقائياً\n    try {\n      await api.post(API_ENDPOINTS.EXAM_PROGRESS(id), { answers: newAnswers });\n    } catch (error) {\n      console.error('فشل حفظ التقدم');\n    }\n  };\n\n  const handleSubmit = async () => {\n    const answeredCount = Object.keys(answers).length;\n    const totalQuestions = exam.questions.length;\n\n    if (answeredCount < totalQuestions) {\n      if (!window.confirm(`لقد أجبت على ${answeredCount} من ${totalQuestions} سؤال. هل تريد التسليم؟`)) {\n        return;\n      }\n    }\n\n    setSubmitting(true);\n\n    try {\n      const response = await api.post(API_ENDPOINTS.SUBMIT_EXAM(id), { answers });\n      \n      if (response.data.success) {\n        navigate(`/exam-result/${id}`, {\n          state: { result: response.data.data }\n        });\n      }\n    } catch (error) {\n      toast.error(error.response?.data?.message || 'حدث خطأ أثناء تسليم الامتحان');\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  if (loading) return <div className=\"loading\">جاري تحميل الامتحان...</div>;\n  if (!exam) return <div className=\"loading\">الامتحان غير موجود</div>;\n\n  return (\n    <div className=\"exam-container\">\n      <div className=\"exam-header\">\n        <h1>{exam.name}</h1>\n        <p>عدد الأسئلة: {exam.questions.length}</p>\n        <div className=\"exam-warning\">\n          ⚠️ لا يمكن النسخ أو اللصق أثناء الامتحان\n        </div>\n      </div>\n\n      <div className=\"questions-container\">\n        {exam.questions.map((question, index) => (\n          <div key={question.id} className=\"question-card\">\n            <h3>السؤال {index + 1}</h3>\n            <p className=\"question-text\">{question.question_text}</p>\n\n            <div className=\"options\">\n              {question.type === 'multiple' ? (\n                // اختيار من متعدد\n                Object.entries(question.options).map(([key, value]) => (\n                  <label key={key} className=\"option\">\n                    <input\n                      type=\"radio\"\n                      name={`question-${question.id}`}\n                      value={key}\n                      checked={answers[question.id] === key}\n                      onChange={() => handleAnswerChange(question.id, key)}\n                    />\n                    <span>{key}) {value}</span>\n                  </label>\n                ))\n              ) : (\n                // صح أو خطأ\n                <>\n                  <label className=\"option\">\n                    <input\n                      type=\"radio\"\n                      name={`question-${question.id}`}\n                      value=\"a\"\n                      checked={answers[question.id] === 'a'}\n                      onChange={() => handleAnswerChange(question.id, 'a')}\n                    />\n                    <span>صح</span>\n                  </label>\n                  <label className=\"option\">\n                    <input\n                      type=\"radio\"\n                      name={`question-${question.id}`}\n                      value=\"b\"\n                      checked={answers[question.id] === 'b'}\n                      onChange={() => handleAnswerChange(question.id, 'b')}\n                    />\n                    <span>خطأ</span>\n                  </label>\n                </>\n              )}\n            </div>\n          </div>\n        ))}\n      </div>\n\n      <div className=\"exam-footer\">\n        <div className=\"progress\">\n          تم الإجابة على {Object.keys(answers).length} من {exam.questions.length} سؤال\n        </div>\n        <button\n          className=\"btn-submit\"\n          onClick={handleSubmit}\n          disabled={submitting}\n        >\n          {submitting ? 'جاري التسليم...' : 'تسليم الامتحان'}\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default Exam;"],"names":["Exam","id","useParams","navigate","useNavigate","user","useAuth","exam","setExam","useState","answers","setAnswers","loading","setLoading","submitting","setSubmitting","useEffect","fetchExam","loadProgress","document","addEventListener","preventCopy","preventContextMenu","removeEventListener","e","preventDefault","toast","error","async","response","api","get","API_ENDPOINTS","EXAM_BY_ID","data","success","EXAM_PROGRESS","console","handleAnswerChange","questionId","answer","newAnswers","_objectSpread","post","_jsx","className","children","_jsxs","name","questions","length","map","question","index","question_text","type","Object","entries","options","_ref","key","value","concat","checked","onChange","_Fragment","keys","onClick","answeredCount","totalQuestions","window","confirm","SUBMIT_EXAM","state","result","_error$response","_error$response$data","message","disabled"],"sourceRoot":""}